# 🎉 Django家用商品推荐系统 - 使用指南

## 📋 项目概述

这是一个基于Django开发的智能家用商品推荐系统，采用协同过滤算法实现个性化推荐。

### ✨ 核心特性
- 🏠 家庭共享购物车
- 🤖 智能推荐算法（协同过滤）
- 📊 用户行为追踪
- ⏰ 商品生命周期管理
- 🎨 现代化UI设计

---

## 🚀 快速开始

### 1️⃣ 启动服务器

```bash
cd /www/wwwroot/version3/version
./start_server.sh
```

或者手动启动：

```bash
su - admin
conda activate django_shop
cd /www/wwwroot/version3/version
python manage.py runserver 0.0.0.0:8080
```

### 2️⃣ 访问系统

在浏览器中打开：
- **用户前端**: `http://服务器IP:8080/`
- **管理后台**: `http://服务器IP:8080/admin/`

### 3️⃣ 登录测试

**管理员账号**：
- 用户名: `mallory`
- 密码: `123456`

**测试用户**：
- 用户名: `user1` 到 `user40`
- 密码: `123456`

---

## 📖 功能使用说明

### 🔐 用户注册
1. 访问注册页面
2. 输入用户名
3. 输入密码（默认123456）
4. 输入家庭名称（如果不存在会自动创建）
5. 点击注册

**注意**：
- 一个用户只能属于一个家庭
- 一个家庭可以有多个成员
- 同一家庭成员共享购物车

### 🏠 首页功能

首页包含以下内容：

1. **欢迎横幅**
   - 显示用户名和家庭信息

2. **家庭画像**
   - 显示家庭偏好的商品分类
   - 可在个人中心设置

3. **为您推荐**
   - 基于协同过滤算法的Top 10推荐
   - 考虑用户行为和家庭画像
   - 包含生命周期推荐

4. **热门商品**
   - 显示最受欢迎的商品

### 🛍️ 商品浏览

**功能**：
- 查看所有商品
- 按分类筛选
- 搜索商品
- 查看商品详情

**操作**：
1. 点击导航栏"商品浏览"
2. 使用搜索框搜索商品
3. 点击分类标签筛选
4. 点击"查看详情"查看商品信息
5. 点击"加入购物车"添加商品

**自动记录**：
- 查看商品详情时自动记录浏览行为

### 🛒 购物车管理

**特点**：
- 家庭成员共享购物车
- 实时计算总价
- 支持修改数量

**操作**：
1. 点击导航栏"购物车"
2. 查看购物车商品
3. 点击 +/- 调整数量
4. 点击"移除"删除商品
5. 点击"结算"创建订单

**自动记录**：
- 添加商品时记录加购行为
- 结算时记录购买行为

### 👤 个人中心

**功能模块**：

1. **用户信息**
   - 显示用户名
   - 显示家庭名称
   - 显示订单数和购物车数量

2. **家庭画像设置**
   - 选择家庭偏好的商品分类
   - 至少选择5个分类
   - 影响推荐结果

3. **订单历史**
   - 查看所有订单
   - 点击查看订单详情

### 📦 订单详情

**显示内容**：
- 订单号
- 下单时间
- 下单用户
- 订单状态
- 商品列表
- 订单总额

---

## 🤖 推荐系统说明

### 推荐算法

系统采用**双重协同过滤**算法：

1. **基于用户的协同过滤**
   - 找到相似用户
   - 推荐相似用户喜欢的商品

2. **基于商品的协同过滤**
   - 找到相似商品
   - 推荐用户喜欢商品的相似商品

3. **加权融合**
   - 融合两种算法的结果
   - 权重比例：50% : 50%

4. **生命周期推荐**
   - 监控已购商品的使用时间
   - 剩余30%时自动推荐

### 用户行为权重

| 行为类型 | 权重 | 说明 |
|---------|------|------|
| 浏览商品 | 1 | 查看商品详情 |
| 加入购物车 | 3 | 添加到购物车 |
| 购买商品 | 5 | 完成订单结算 |

### 推荐更新

推荐结果会根据以下因素实时更新：
- 用户浏览行为
- 购物车操作
- 订单购买
- 家庭画像设置

---

## 🎯 使用场景示例

### 场景1：新用户注册

```
1. 访问注册页面
2. 用户名: user_test
3. 密码: 123456
4. 家庭名称: 测试家庭
5. 注册成功，自动创建家庭和购物车
```

### 场景2：设置家庭画像

```
1. 登录后进入个人中心
2. 在"家庭画像设置"区域
3. 勾选偏好的商品分类（如：食品饮料、个人护理等）
4. 点击"保存设置"
5. 返回首页查看推荐变化
```

### 场景3：购物流程

```
1. 浏览商品页面（记录浏览行为）
2. 点击商品查看详情
3. 点击"加入购物车"（记录加购行为）
4. 进入购物车页面
5. 调整商品数量
6. 点击"结算"
7. 创建订单（记录购买行为）
8. 查看订单详情
```

### 场景4：家庭成员协同购物

```
用户A（家庭1）:
1. 登录系统
2. 添加商品到购物车

用户B（家庭1）:
1. 登录系统
2. 查看购物车（看到用户A添加的商品）
3. 继续添加商品
4. 结算订单（所有商品一起结算）
```

---

## 📊 数据统计

### 当前系统数据

- ✅ **用户数**: 40个
- ✅ **家庭数**: 20个
- ✅ **商品分类**: 15个
- ✅ **商品总数**: 400个
- ✅ **用户行为**: 683条
- ✅ **订单数**: 67个

### 商品分类列表

1. 食品饮料
2. 生鲜果蔬
3. 美妆护肤
4. 个人护理
5. 家居清洁
6. 厨房用品
7. 家居装饰
8. 床上用品
9. 母婴用品
10. 宠物用品
11. 数码配件
12. 运动健身
13. 图书文具
14. 服装鞋帽
15. 箱包配饰

---

## 🔧 管理后台使用

### 访问后台

URL: `http://服务器IP:8080/admin/`

**登录信息**：
- 用户名: `mallory`
- 密码: `123456`

### 后台功能

1. **用户管理**
   - 查看所有用户
   - 编辑用户信息
   - 查看用户所属家庭

2. **家庭管理**
   - 查看所有家庭
   - 查看家庭成员数量
   - 管理家庭画像

3. **商品管理**
   - 添加/编辑/删除商品
   - 设置商品价格和库存
   - 设置商品生命周期

4. **分类管理**
   - 管理商品分类
   - 查看分类下的商品数量

5. **订单管理**
   - 查看所有订单
   - 查看订单详情
   - 修改订单状态

6. **用户行为**
   - 查看所有用户行为记录
   - 按行为类型筛选
   - 查看行为评分

---

## 🎨 界面特色

### 设计风格
- **配色**: 紫色渐变主题
- **字体**: 现代化无衬线字体
- **动画**: 流畅的过渡效果
- **布局**: 响应式设计

### 动画效果
- 淡入淡出
- 滑入滑出
- 弹出效果
- 悬停变化

---

## 📈 推荐系统评估

### 运行评估

```bash
cd /www/wwwroot/version3/version
python scripts/evaluate_recommender.py
```

### 评估指标

- **准确率 (Precision)**: 推荐商品中用户实际购买的比例
- **召回率 (Recall)**: 用户购买商品中被推荐的比例
- **F1分数**: 准确率和召回率的调和平均

### 评估说明

初始评估分数可能较低，这是正常现象：
- 推荐系统推荐的是用户**可能感兴趣但未购买**的商品
- 目的是发现新的购物需求
- 随着用户行为增加，准确度会提高

---

## 🔄 重新生成数据

如果需要重新生成测试数据：

```bash
cd /www/wwwroot/version3/version
python scripts/generate_test_data.py
```

这将：
- 清空现有数据
- 重新生成40个用户
- 重新生成20个家庭
- 重新生成400个商品
- 重新生成用户行为数据

---

## ❓ 常见问题

### Q1: 推荐列表为空？
**A**: 需要有足够的用户行为数据。尝试：
1. 浏览更多商品
2. 添加商品到购物车
3. 完成订单购买

### Q2: 购物车不共享？
**A**: 确认用户属于同一家庭：
1. 进入个人中心查看家庭名称
2. 确保两个用户的家庭名称相同

### Q3: 无法登录？
**A**: 检查：
1. 用户名是否正确（user1-user40）
2. 密码是否为123456
3. 是否已注册

### Q4: 服务器无法启动？
**A**: 检查：
1. 8080端口是否被占用
2. 虚拟环境是否激活
3. 依赖是否安装完整

### Q5: 推荐结果不准确？
**A**: 这是正常的：
1. 推荐系统需要学习用户偏好
2. 多进行一些浏览和购买操作
3. 设置家庭画像可以改善推荐

---

## 📞 技术支持

### 文档资源
- `README.md` - 项目说明
- `DEPLOYMENT.md` - 部署文档
- `SUMMARY.md` - 项目总结
- `GUIDE.md` - 本使用指南

### 日志查看
```bash
# 查看服务器日志
tail -f server.log

# 查看Django输出
python manage.py runserver 0.0.0.0:8080
```

---

## 🎓 学习建议

### 推荐学习路径

1. **基础使用**
   - 注册登录
   - 浏览商品
   - 添加购物车
   - 完成订单

2. **高级功能**
   - 设置家庭画像
   - 观察推荐变化
   - 多用户协同购物

3. **后台管理**
   - 管理商品
   - 查看数据统计
   - 分析用户行为

4. **算法理解**
   - 阅读推荐算法代码
   - 运行评估脚本
   - 理解协同过滤原理

---

## 🌟 最佳实践

### 用户使用建议
1. 设置完整的家庭画像
2. 多浏览感兴趣的商品
3. 定期查看推荐列表
4. 利用生命周期提醒

### 管理员建议
1. 定期更新商品信息
2. 监控用户行为数据
3. 分析推荐效果
4. 优化商品分类

---

## 🎉 开始使用

现在您已经了解了系统的所有功能，可以开始使用了！

**第一步**：启动服务器
```bash
cd /www/wwwroot/version3/version
./start_server.sh
```

**第二步**：访问系统
```
http://服务器IP:8080/
```

**第三步**：登录测试账号
```
用户名: user1
密码: 123456
```

**第四步**：开始探索！

---

**祝您使用愉快！** 🎊

如有问题，请查阅相关文档或检查日志输出。

