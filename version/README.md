# å®¶ç”¨å•†å“æ¨èç³»ç»Ÿ

åŸºäºDjangoçš„æ™ºèƒ½å®¶ç”¨å•†å“æ¨èç³»ç»Ÿï¼Œé‡‡ç”¨ååŒè¿‡æ»¤ç®—æ³•å®ç°ä¸ªæ€§åŒ–æ¨èã€‚

## é¡¹ç›®ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- âœ… ç”¨æˆ·å’Œç®¡ç†å‘˜åˆ†ç¦»ç™»å½•ç³»ç»Ÿ
- âœ… å®¶åº­å…±äº«è´­ç‰©è½¦æœºåˆ¶
- âœ… å®¶åº­ç”»åƒç®¡ç†ï¼ˆå•†å“åˆ†ç±»åå¥½ï¼‰
- âœ… æ™ºèƒ½æ¨èç®—æ³•ï¼ˆååŒè¿‡æ»¤ï¼‰
- âœ… å•†å“ç”Ÿå‘½å‘¨æœŸç®¡ç†
- âœ… ç”¨æˆ·è¡Œä¸ºè¿½è¸ªï¼ˆæµè§ˆã€åŠ è´­ã€è´­ä¹°ï¼‰
- âœ… è®¢å•ç®¡ç†ç³»ç»Ÿ

### æ¨èç®—æ³•
- **åŸºäºç”¨æˆ·çš„ååŒè¿‡æ»¤** (User-based Collaborative Filtering)
- **åŸºäºå•†å“çš„ååŒè¿‡æ»¤** (Item-based Collaborative Filtering)
- **ä½™å¼¦ç›¸ä¼¼åº¦è®¡ç®—**
- **è¯„åˆ†å½’ä¸€åŒ–å¤„ç†**
- **åŠ æƒèåˆç®—æ³•** (alpha=0.5)
- **ç”Ÿå‘½å‘¨æœŸè§¦å‘æ¨è** (å‰©ä½™30%æ—¶æ¨è)

### æŠ€æœ¯æ ˆ
- **åç«¯**: Django 4.2
- **æ•°æ®åº“**: SQLite
- **ç®—æ³•åº“**: NumPy
- **å‰ç«¯**: HTML5 + CSS3 (å“åº”å¼è®¾è®¡)
- **Python**: 3.9+

## é¡¹ç›®ç»“æ„

```
version3/version/
â”œâ”€â”€ manage.py                 # Djangoç®¡ç†è„šæœ¬
â”œâ”€â”€ requirements.txt          # é¡¹ç›®ä¾èµ–
â”œâ”€â”€ start_server.sh          # å¯åŠ¨è„šæœ¬
â”œâ”€â”€ db.sqlite3               # æ•°æ®åº“æ–‡ä»¶
â”œâ”€â”€ evaluation_report.txt    # è¯„ä¼°æŠ¥å‘Š
â”œâ”€â”€ version/                 # é¡¹ç›®é…ç½®
â”‚   â”œâ”€â”€ settings.py         # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ urls.py             # ä¸»URLé…ç½®
â”‚   â””â”€â”€ wsgi.py             # WSGIé…ç½®
â”œâ”€â”€ shop/                    # ä¸»åº”ç”¨
â”‚   â”œâ”€â”€ models.py           # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ views.py            # è§†å›¾å‡½æ•°
â”‚   â”œâ”€â”€ urls.py             # URLè·¯ç”±
â”‚   â”œâ”€â”€ admin.py            # åå°ç®¡ç†
â”‚   â”œâ”€â”€ recommender.py      # æ¨èç®—æ³•å¼•æ“
â”‚   â””â”€â”€ migrations/         # æ•°æ®åº“è¿ç§»
â”œâ”€â”€ templates/               # æ¨¡æ¿æ–‡ä»¶
â”‚   â”œâ”€â”€ base.html           # åŸºç¡€æ¨¡æ¿
â”‚   â”œâ”€â”€ login.html          # ç™»å½•é¡µé¢
â”‚   â”œâ”€â”€ register.html       # æ³¨å†Œé¡µé¢
â”‚   â”œâ”€â”€ home.html           # é¦–é¡µ
â”‚   â”œâ”€â”€ products.html       # å•†å“æµè§ˆ
â”‚   â”œâ”€â”€ product_detail.html # å•†å“è¯¦æƒ…
â”‚   â”œâ”€â”€ cart.html           # è´­ç‰©è½¦
â”‚   â”œâ”€â”€ profile.html        # ä¸ªäººä¸­å¿ƒ
â”‚   â””â”€â”€ order_detail.html   # è®¢å•è¯¦æƒ…
â”œâ”€â”€ static/                  # é™æ€æ–‡ä»¶
â”‚   â”œâ”€â”€ css/
â”‚   â””â”€â”€ js/
â””â”€â”€ scripts/                 # è„šæœ¬å·¥å…·
    â”œâ”€â”€ generate_test_data.py      # æµ‹è¯•æ•°æ®ç”Ÿæˆ
    â””â”€â”€ evaluate_recommender.py    # æ¨èç³»ç»Ÿè¯„ä¼°
```

## æ•°æ®æ¨¡å‹

### æ ¸å¿ƒæ¨¡å‹
1. **User** - ç”¨æˆ·æ¨¡å‹ï¼ˆæ‰©å±•Django Userï¼‰
2. **Family** - å®¶åº­æ¨¡å‹
3. **FamilyProfile** - å®¶åº­ç”»åƒ
4. **Category** - å•†å“åˆ†ç±»
5. **Product** - å•†å“
6. **Cart** - è´­ç‰©è½¦
7. **CartItem** - è´­ç‰©è½¦é¡¹
8. **Order** - è®¢å•
9. **OrderItem** - è®¢å•é¡¹
10. **UserBehavior** - ç”¨æˆ·è¡Œä¸ºè®°å½•

## å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# è¿›å…¥è™šæ‹Ÿç¯å¢ƒ
su - admin
conda activate django_shop
cd /www/wwwroot/version3/version
```

### 2. å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### 3. æ•°æ®åº“è¿ç§»

```bash
python manage.py makemigrations
python manage.py migrate
```

### 4. ç”Ÿæˆæµ‹è¯•æ•°æ®

```bash
python scripts/generate_test_data.py
```

è¿™å°†ç”Ÿæˆï¼š
- 40ä¸ªç”¨æˆ·ï¼ˆuser1-user40ï¼‰
- 20ä¸ªå®¶åº­ï¼ˆæ¯å®¶åº­2ä¸ªç”¨æˆ·ï¼‰
- 15ä¸ªå•†å“åˆ†ç±»
- 400ä¸ªå•†å“
- æ¯ä¸ªç”¨æˆ·è‡³å°‘5ä¸ªè¡Œä¸ºï¼ˆå«2ä¸ªè´­ä¹°è¡Œä¸ºï¼‰

### 5. å¯åŠ¨æœåŠ¡å™¨

```bash
# æ–¹å¼1ï¼šä½¿ç”¨å¯åŠ¨è„šæœ¬
./start_server.sh

# æ–¹å¼2ï¼šç›´æ¥å¯åŠ¨
python manage.py runserver 0.0.0.0:8080
```

### 6. è®¿é—®ç³»ç»Ÿ

åœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼š`http://æœåŠ¡å™¨IP:8080`

## ç™»å½•ä¿¡æ¯

### ç®¡ç†å‘˜è´¦å·
- ç”¨æˆ·åï¼š`mallory`
- å¯†ç ï¼š`123456`
- è®¿é—®åå°ï¼š`http://æœåŠ¡å™¨IP:8080/admin/`

### æ™®é€šç”¨æˆ·è´¦å·
- ç”¨æˆ·åï¼š`user1` åˆ° `user40`
- å¯†ç ï¼š`123456`ï¼ˆæ‰€æœ‰ç”¨æˆ·ç»Ÿä¸€å¯†ç ï¼‰

## åŠŸèƒ½è¯´æ˜

### 1. ç”¨æˆ·æ³¨å†Œ
- å¡«å†™ç”¨æˆ·åã€å¯†ç å’Œå®¶åº­åç§°
- å¦‚æœå®¶åº­ä¸å­˜åœ¨åˆ™è‡ªåŠ¨åˆ›å»º
- ä¸€ä¸ªç”¨æˆ·åªèƒ½å±äºä¸€ä¸ªå®¶åº­

### 2. å®¶åº­å…±äº«è´­ç‰©è½¦
- åŒä¸€å®¶åº­çš„æ‰€æœ‰æˆå‘˜å…±äº«ä¸€ä¸ªè´­ç‰©è½¦
- ä¸åŒå®¶åº­çš„è´­ç‰©è½¦å®Œå…¨éš”ç¦»
- æ‰€æœ‰å®¶åº­æˆå‘˜éƒ½å¯ä»¥ç»“ç®—

### 3. å®¶åº­ç”»åƒ
- åœ¨ä¸ªäººä¸­å¿ƒè®¾ç½®å®¶åº­åå¥½çš„å•†å“åˆ†ç±»
- æ¨èç®—æ³•ä¼šè€ƒè™‘å®¶åº­ç”»åƒ
- åŒä¸€å®¶åº­æˆå‘˜å…±äº«ç”»åƒè®¾ç½®

### 4. æ™ºèƒ½æ¨è
- é¦–é¡µæ˜¾ç¤ºTop 10æ¨èå•†å“
- åŸºäºç”¨æˆ·è¡Œä¸ºçš„ååŒè¿‡æ»¤
- è€ƒè™‘å•†å“ç”Ÿå‘½å‘¨æœŸ
- å®æ—¶æ›´æ–°æ¨èç»“æœ

### 5. å•†å“ç”Ÿå‘½å‘¨æœŸ
- æ¯ä¸ªå•†å“æœ‰ç”Ÿå‘½å‘¨æœŸï¼ˆå¤©æ•°ï¼‰
- è´­ä¹°åè‡ªåŠ¨è®¡ç®—ä½¿ç”¨æ—¶é—´
- å‰©ä½™30%æ—¶è‡ªåŠ¨å‡ºç°åœ¨æ¨èåˆ—è¡¨

### 6. ç”¨æˆ·è¡Œä¸ºè¿½è¸ª
- **æµè§ˆè¡Œä¸º**ï¼šæŸ¥çœ‹å•†å“è¯¦æƒ…æ—¶è®°å½•ï¼ˆæƒé‡=1ï¼‰
- **åŠ è´­è¡Œä¸º**ï¼šæ·»åŠ åˆ°è´­ç‰©è½¦æ—¶è®°å½•ï¼ˆæƒé‡=3ï¼‰
- **è´­ä¹°è¡Œä¸º**ï¼šç»“ç®—è®¢å•æ—¶è®°å½•ï¼ˆæƒé‡=5ï¼‰

## æ¨èç®—æ³•è¯„ä¼°

è¿è¡Œè¯„ä¼°è„šæœ¬ï¼š

```bash
python scripts/evaluate_recommender.py
```

è¯„ä¼°æŒ‡æ ‡ï¼š
- **å‡†ç¡®ç‡ (Precision)**ï¼šæ¨èå•†å“ä¸­ç”¨æˆ·å®é™…è´­ä¹°çš„æ¯”ä¾‹
- **å¬å›ç‡ (Recall)**ï¼šç”¨æˆ·è´­ä¹°å•†å“ä¸­è¢«æ¨èçš„æ¯”ä¾‹
- **F1åˆ†æ•°**ï¼šå‡†ç¡®ç‡å’Œå¬å›ç‡çš„è°ƒå’Œå¹³å‡

è¯„ä¼°æŠ¥å‘Šä¿å­˜åœ¨ï¼š`evaluation_report.txt`

## ç®¡ç†åå°

è®¿é—® `http://æœåŠ¡å™¨IP:8080/admin/` å¯ä»¥ï¼š
- ç®¡ç†ç”¨æˆ·å’Œå®¶åº­
- ç®¡ç†å•†å“å’Œåˆ†ç±»
- æŸ¥çœ‹è®¢å•å’Œè´­ç‰©è½¦
- æŸ¥çœ‹ç”¨æˆ·è¡Œä¸ºæ•°æ®
- ç®¡ç†å®¶åº­ç”»åƒ

## é¡µé¢å±•ç¤º

### é¦–é¡µ
- æ¬¢è¿ä¿¡æ¯
- å®¶åº­ç”»åƒå±•ç¤º
- ä¸ªæ€§åŒ–æ¨èåˆ—è¡¨ï¼ˆTop 10ï¼‰
- çƒ­é—¨å•†å“å±•ç¤º

### å•†å“æµè§ˆ
- å•†å“åˆ—è¡¨å±•ç¤º
- åˆ†ç±»ç­›é€‰
- æœç´¢åŠŸèƒ½
- å•†å“è¯¦æƒ…æŸ¥çœ‹

### è´­ç‰©è½¦
- å•†å“åˆ—è¡¨
- æ•°é‡è°ƒæ•´
- ä»·æ ¼è®¡ç®—
- ä¸€é”®ç»“ç®—

### ä¸ªäººä¸­å¿ƒ
- ç”¨æˆ·ä¿¡æ¯
- å®¶åº­ä¿¡æ¯
- è®¢å•å†å²
- å®¶åº­ç”»åƒè®¾ç½®

## æµ‹è¯•æ•°æ®è¯´æ˜

### ç”¨æˆ·åˆ†å¸ƒ
- 40ä¸ªç”¨æˆ·åˆ†å¸ƒåœ¨20ä¸ªå®¶åº­
- æ¯ä¸ªå®¶åº­2ä¸ªæˆå‘˜
- å®¶åº­åç§°ï¼šå®¶åº­1 åˆ° å®¶åº­20

### å•†å“åˆ†å¸ƒ
- 15ä¸ªåˆ†ç±»ï¼Œæ¯ä¸ªåˆ†ç±»çº¦27ä¸ªå•†å“
- ä»·æ ¼èŒƒå›´ï¼šÂ¥10 - Â¥500
- åº“å­˜èŒƒå›´ï¼š50 - 500ä»¶
- ç”Ÿå‘½å‘¨æœŸï¼š7/15/30/60/90/180å¤©

### è¡Œä¸ºæ•°æ®
- æ¯ä¸ªç”¨æˆ·5-15ä¸ªè¡Œä¸ºè®°å½•
- ä¿è¯æ¯ä¸ªç”¨æˆ·è‡³å°‘2ä¸ªè´­ä¹°è¡Œä¸º
- è¡Œä¸ºç±»å‹åˆ†å¸ƒï¼šæµè§ˆ > åŠ è´­ > è´­ä¹°

## æ€§èƒ½ä¼˜åŒ–

1. **æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–**
   - ä½¿ç”¨ `select_related` å‡å°‘æŸ¥è¯¢æ¬¡æ•°
   - ä½¿ç”¨ `prefetch_related` ä¼˜åŒ–å¤šå¯¹å¤šå…³ç³»

2. **æ¨èç®—æ³•ä¼˜åŒ–**
   - çŸ©é˜µè¿ç®—ä½¿ç”¨NumPyåŠ é€Ÿ
   - ç›¸ä¼¼åº¦è®¡ç®—ç¼“å­˜
   - è¯„åˆ†å½’ä¸€åŒ–å¤„ç†

3. **å‰ç«¯ä¼˜åŒ–**
   - CSSåŠ¨ç”»ä½¿ç”¨GPUåŠ é€Ÿ
   - å“åº”å¼è®¾è®¡é€‚é…ç§»åŠ¨ç«¯
   - æ¸è¿›å¼åŠ è½½æå‡ä½“éªŒ

## æ³¨æ„äº‹é¡¹

1. **ç«¯å£é…ç½®**ï¼šç³»ç»Ÿè¿è¡Œåœ¨8080ç«¯å£ï¼Œç¡®ä¿ç«¯å£æœªè¢«å ç”¨
2. **æ•°æ®åº“**ï¼šä½¿ç”¨SQLiteï¼Œç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨MySQL/PostgreSQL
3. **å¯†ç å®‰å…¨**ï¼šæµ‹è¯•ç¯å¢ƒä½¿ç”¨ç»Ÿä¸€å¯†ç ï¼Œç”Ÿäº§ç¯å¢ƒéœ€è¦å¼ºåŒ–å¯†ç ç­–ç•¥
4. **é™æ€æ–‡ä»¶**ï¼šç”Ÿäº§ç¯å¢ƒéœ€è¦è¿è¡Œ `python manage.py collectstatic`

## æ•…éšœæ’æŸ¥

### æœåŠ¡å™¨æ— æ³•å¯åŠ¨
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tlnp | grep 8080

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
python manage.py runserver 0.0.0.0:8080
```

### æ¨èç»“æœä¸ºç©º
```bash
# é‡æ–°ç”Ÿæˆæµ‹è¯•æ•°æ®
python scripts/generate_test_data.py

# æ£€æŸ¥ç”¨æˆ·è¡Œä¸ºæ•°æ®
python manage.py shell
>>> from shop.models import UserBehavior
>>> UserBehavior.objects.count()
```

### æ•°æ®åº“é”™è¯¯
```bash
# é‡ç½®æ•°æ®åº“
rm db.sqlite3
python manage.py migrate
python scripts/generate_test_data.py
```

## å¼€å‘å›¢é˜Ÿ

- é¡¹ç›®ç±»å‹ï¼šDjangoå®¶ç”¨å•†å“æ¨èç³»ç»Ÿ
- å¼€å‘æ—¶é—´ï¼š2026å¹´2æœˆ
- æŠ€æœ¯æ”¯æŒï¼šåŸºäºååŒè¿‡æ»¤çš„æ¨èç®—æ³•

## è®¸å¯è¯

æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ã€‚

---

**ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼** ğŸ‰

